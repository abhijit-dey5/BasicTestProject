Import-Module WebAdministration
Get-ChildItem -Path IIS:\sites | Foreach-Object `
    {
        if ($_.Name -ne "Default Web Site") {
            Remove-Website $_.Name
        }
    }
Get-ChildItem -Path IIS:\AppPools| ForEach-Object `
    {
        if($_.Name -ne "DefaultAppPool" -or $_.Name -ne "Classic .NET AppPool" -or $_.Name -ne ".NET v4.5 Classic" -or $_.Name -ne ".NET v4.5" -or $_.Name -ne ".NET v2.0 Classic" -or $_.Name -ne ".NET v2.0"){
            Remove-WebAppPool $_.Name
        }

    }